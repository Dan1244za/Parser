{% extends "base.html" %}

{% block title %}{{ article.title[:50] }}... - News Parser{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Dashboard</a></li>
                        <li class="breadcrumb-item active">Article Details</li>
                    </ol>
                </nav>
            </div>
            <div class="card-body">
                <h1 class="card-title">{{ article.title }}</h1>
                
                <div class="mb-3">
                    <div class="d-flex flex-wrap gap-2">
                        <span class="badge bg-secondary">{{ article.category }}</span>
                        <span class="badge bg-info">{{ article.source }}</span>
                        {% if article.sentiment_polarity > 0.1 %}
                        <span class="badge bg-success">
                            <i class="fas fa-smile"></i> Positive Sentiment
                        </span>
                        {% elif article.sentiment_polarity < -0.1 %}
                        <span class="badge bg-danger">
                            <i class="fas fa-frown"></i> Negative Sentiment
                        </span>
                        {% else %}
                        <span class="badge bg-secondary">
                            <i class="fas fa-meh"></i> Neutral Sentiment
                        </span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="mb-3">
                    <p class="text-muted">
                        <i class="fas fa-calendar"></i> Published: {{ article.published if article.published else 'Unknown date' }}
                    </p>
                </div>
                
                <div class="mb-4">
                    <h5>Summary</h5>
                    <p>{{ article.summary }}</p>
                </div>
                
                {% if article.keywords %}
                <div class="mb-4">
                    <h5>Keywords</h5>
                    <div class="d-flex flex-wrap gap-2">
                        {% for keyword in article.keywords %}
                        <span class="badge bg-light text-dark">{{ keyword }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-start">
                    <a href="{{ article.link }}" target="_blank" class="btn btn-primary">
                        <i class="fas fa-external-link-alt"></i> Read Full Article
                    </a>
                    <a href="{{ url_for('index') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-chart-line"></i> Analysis</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <h6>Sentiment Analysis</h6>
                    <div class="row">
                        <div class="col-6">
                            <small class="text-muted">Polarity</small>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar {% if article.sentiment_polarity > 0 %}bg-success{% elif article.sentiment_polarity < 0 %}bg-danger{% else %}bg-secondary{% endif %}" 
                                     style="width: {{ ((article.sentiment_polarity + 1) / 2 * 100)|round(1) }}%">
                                    {{ "%.3f"|format(article.sentiment_polarity) }}
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Subjectivity</small>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar bg-info" 
                                     style="width: {{ (article.sentiment_subjectivity * 100)|round(1) }}%">
                                    {{ "%.3f"|format(article.sentiment_subjectivity) }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6>Article Metadata</h6>
                    <table class="table table-sm">
                        <tr>
                            <td><strong>Source:</strong></td>
                            <td>{{ article.source }}</td>
                        </tr>
                        <tr>
                            <td><strong>Category:</strong></td>
                            <td>{{ article.category }}</td>
                        </tr>
                        <tr>
                            <td><strong>Source Type:</strong></td>
                            <td>{{ article.source_type }}</td>
                        </tr>
                        {% if article.analysis_timestamp %}
                        <tr>
                            <td><strong>Analyzed:</strong></td>
                            <td>{{ article.analysis_timestamp[:19] }}</td>
                        </tr>
                        {% endif %}
                    </table>
                </div>
                
                {% if article.keyword_scores %}
                <div class="mb-3">
                    <h6>Top Keywords</h6>
                    <div class="list-group list-group-flush">
                        {% for keyword, score in article.keyword_scores.items()[:5] %}
                        <div class="list-group-item d-flex justify-content-between align-items-center py-1">
                            <span>{{ keyword }}</span>
                            <span class="badge bg-primary rounded-pill">{{ score }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="fas fa-info-circle"></i> About Sentiment Analysis</h5>
            </div>
            <div class="card-body">
                <p class="small">
                    <strong>Polarity:</strong> Ranges from -1 (very negative) to +1 (very positive). 
                    Values close to 0 indicate neutral sentiment.
                </p>
                <p class="small">
                    <strong>Subjectivity:</strong> Ranges from 0 (very objective) to 1 (very subjective). 
                    Higher values indicate more opinion-based content.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}